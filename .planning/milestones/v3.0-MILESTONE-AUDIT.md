---
milestone: v3.0
audited: 2026-02-08
status: tech_debt
scores:
  requirements: 34/34
  phases: 6/6
  integration: 12/12
  flows: 4/4
gaps:
  requirements: []
  integration: []
  flows: []
tech_debt:
  - phase: 85-theatre-erasure
    items:
      - "Orphaned: game.acknowledgeAnimationEvents() still exists on Game class but nothing calls it -- dead code in v3.0 architecture"
  - phase: 90-documentation-migration
    items:
      - "Fixed during audit: CribbageBoard.vue was reading animation events from wrong path (props.gameView?.attributes?.animationEvents instead of injecting from GameShell via useAnimationEvents())"
---

# v3.0 Animation Timeline — Milestone Audit

**Audited:** 2026-02-08
**Status:** TECH_DEBT (no blockers, 1 dead code item)

## Requirements Coverage: 34/34

All v1 requirements satisfied.

| Category | Requirements | Status |
|----------|-------------|--------|
| Engine (ENG-01 to ENG-04) | 4 | All satisfied (Phase 86) |
| Removal (REM-01 to REM-06) | 6 | All satisfied (Phase 85) |
| Session (SES-01 to SES-04) | 4 | All satisfied (Phase 87) |
| Client (CLI-01 to CLI-11) | 11 | All satisfied (Phase 88, 89) |
| UI (UI-01 to UI-03) | 3 | All satisfied (Phase 89) |
| Documentation (DOC-01 to DOC-06) | 6 | All satisfied (Phase 85, 90) |

## Phase Verification: 6/6

| Phase | Plans | Verification | Status |
|-------|-------|-------------|--------|
| 85: Theatre Erasure | 4/4 | 85-VERIFICATION.md | PASSED (5/5 truths) |
| 86: Simplified Animation Events | 1/1 | 86-VERIFICATION.md | PASSED (6/6 truths) |
| 87: Session Simplification | 1/1 | 87-VERIFICATION.md | PASSED (6/6 truths) |
| 88: Client Animation Queue | 1/1 | 88-VERIFICATION.md | PASSED (6/6 truths) |
| 89: UI Integration | 1/1 | 89-VERIFICATION.md | PASSED (6/6 truths) |
| 90: Documentation & Migration | 2/2 | (summaries only) | PASSED (browser verified) |

## Cross-Phase Integration: 12/12 links connected

| # | Link | From | To | Status |
|---|------|------|----|--------|
| 1 | Engine → Session | game.animate() → buildPlayerState() | Phase 86 → 87 | CONNECTED |
| 2 | Session → Client | PlayerGameState.animationEvents → GameShell | Phase 87 → 89 | CONNECTED |
| 3 | Client → UI | useAnimationEvents → ActionPanel gating | Phase 88 → 89 | CONNECTED |
| 4 | Skip flow | ActionPanel → skipAll() → AbortController | Phase 89 → 90 | CONNECTED |
| 5 | Wait-for-handler | processQueue → registerHandler | Phase 88 | CONNECTED |
| 6 | Serialization | commandHistory → toJSON → restoreGame | Phase 86 | CONNECTED |
| 7 | AnimateCommand | types → executor → inverse | Phase 86 | CONNECTED |
| 8 | AnimationEvent type | engine → session → UI | Cross-phase | CONNECTED |
| 9 | Theatre erasure | All removed APIs | Phase 85 | VERIFIED CLEAN |
| 10 | Example game: demo-animation | useAnimationEvents() injection | Phase 90 | CONNECTED |
| 11 | Example game: cribbage | useAnimationEvents() injection | Phase 90 (fixed during audit) | CONNECTED |
| 12 | Documentation chain | BREAKING.md → migration-guide.md → ui-components.md | Phase 85 → 90 | CONSISTENT |

## E2E Flows: 4/4 verified

| Flow | Path | Status |
|------|------|--------|
| Happy path | animate() → session → client queue → handler → ActionPanel | COMPLETE |
| Skip | ActionPanel Skip → skipAll() → AbortController → immediate unblock | COMPLETE |
| Late mount | Event arrives → wait-for-handler → component mounts → resume | COMPLETE |
| Reconnection | Reconnect → buildPlayerState → truth + events | COMPLETE |

## Test Coverage

| Test File | Tests | Phase |
|-----------|-------|-------|
| animation-events.test.ts | 17 | Phase 86 |
| build-player-state.test.ts | 5 | Phase 87 |
| useAnimationEvents.test.ts | 39 | Phase 88, 90 |
| **Total** | **61** | |

Full suite: 540/540 tests passing.

## Issues Found During Audit

### Fixed: Cribbage animation events path (Critical)

**File:** `~/BoardSmithGames/cribbage/src/ui/components/CribbageBoard.vue`
**Problem:** Was creating its own animation events controller reading from `props.gameView?.attributes?.animationEvents` (always `undefined` — events are at game JSON root, not in `attributes`). Also overriding GameShell's provider.
**Fix:** Changed to `useAnimationEvents()` to inject from GameShell (correct pattern, matches demo-animation).
**Commit:** `957bd33` in cribbage repo.

### Tech Debt: Orphaned acknowledgeAnimationEvents (Minor)

**File:** `src/engine/element/game.ts:2416-2418`
**Issue:** `game.acknowledgeAnimationEvents(upToId)` still exists as a 1-line buffer filter, but nothing in session, server, client, or UI calls it. Dead code in v3.0 architecture.
**BREAKING.md says:** "No replacement -- client manages playback locally"
**Impact:** None functional. Minor dead code.
**Recommendation:** Remove in next cleanup pass.
