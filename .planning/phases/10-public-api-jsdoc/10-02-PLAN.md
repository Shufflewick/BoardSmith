---
phase: 10-public-api-jsdoc
plan: 02
type: execute
---

<objective>
Add JSDoc documentation to the engine action and flow systems - the APIs for defining player choices and game flow.

Purpose: Action and Flow are the two most complex APIs in BoardSmith. Clear documentation helps game developers understand the builder patterns.
Output: JSDoc comments on Action builder, ActionExecutor, flow builder functions, and FlowEngine class.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-public-api-jsdoc/10-01-SUMMARY.md

# Key files to document:
@packages/engine/src/action/action-builder.ts
@packages/engine/src/action/action.ts
@packages/engine/src/action/filter-helpers.ts
@packages/engine/src/flow/builders.ts
@packages/engine/src/flow/engine.ts

# Reference for JSDoc style:
@packages/engine/src/flow/builders.ts (already has some JSDoc - enhance)
@packages/ui/src/composables/useActionController.ts (comprehensive JSDoc)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add JSDoc to Action builder</name>
  <files>packages/engine/src/action/action-builder.ts</files>
  <action>
Add JSDoc documentation to the Action builder class:

**Class-level:**
- Explain the fluent builder pattern for defining player actions
- Include @example showing a complete action definition

**Key methods to document:**
- `chooseFrom()` - Select from choices
- `fromElements()` / `selectElements()` - Select game elements
- `enterText()` - Text input
- `enterNumber()` - Number input
- `validate()` - Add validation
- `do()` - Action execution
- `skipIf()` / `condition()` - Conditional availability
- `message()` - Action message
- `confirm()` - Confirmation prompt
- `repeat()` - Repeating selections

For each method:
- 1-sentence description
- @param for each parameter
- @returns for chaining
- @example for complex methods (chooseFrom, fromElements, do)

Focus on the methods game developers use - not internal helpers.
  </action>
  <verify>TypeScript compiles: `cd /Users/jtsmith/board_game_service/BoardSmith && pnpm exec tsc --noEmit -p packages/engine`</verify>
  <done>Action builder has comprehensive JSDoc on class and fluent methods</done>
</task>

<task type="auto">
  <name>Task 2: Add JSDoc to filter helpers and ActionExecutor</name>
  <files>packages/engine/src/action/filter-helpers.ts, packages/engine/src/action/action.ts</files>
  <action>
**filter-helpers.ts:**
Add JSDoc to exported filter helper functions used in multi-step selections:
- `dependentFilter()` - Filter based on previous selections
- `adjacentToSelection()` - Filter to adjacent elements
- `excludeAlreadySelected()` - Exclude previously selected items
- `allOf()` / `anyOf()` / `not()` - Combine filters

For each function:
- 1-2 sentence description
- @param documentation
- @example showing typical usage in an action

**action.ts (ActionExecutor class):**
Add JSDoc to the ActionExecutor class:
- Class-level: Explain its role in resolving and executing actions
- `resolveArgs()` - Brief description (internal but useful to understand)
- Keep brief - this is mostly internal API

Do NOT heavily document internal methods.
  </action>
  <verify>TypeScript compiles: `cd /Users/jtsmith/board_game_service/BoardSmith && pnpm exec tsc --noEmit -p packages/engine`</verify>
  <done>Filter helpers and ActionExecutor have JSDoc documentation</done>
</task>

<task type="auto">
  <name>Task 3: Enhance flow builder JSDoc</name>
  <files>packages/engine/src/flow/builders.ts, packages/engine/src/flow/engine.ts</files>
  <action>
**builders.ts:**
Enhance existing JSDoc on flow builder functions. Many already have basic docs - add:
- `sequence()` - enhance @example
- `loop()` - already good, check for completeness
- `repeat()` - add @example
- `eachPlayer()` - add @example showing player turn
- `forEach()` - add @example
- `actionStep()` - comprehensive docs, this is the key function
- `simultaneousActionStep()` - document how it differs from actionStep
- `playerActions()` - document the player actions pattern
- `switchOn()` - add @example
- `ifThen()` - add @example
- `defineFlow()` - comprehensive docs on the full flow definition
- `turnLoop()` - document this convenience function
- `execute()` - document running arbitrary code in flow
- `setVar()` - document flow variables
- `noop()` - brief description

**engine.ts:**
FlowEngine already has section dividers (from Phase 9). Add:
- Class-level JSDoc explaining the engine's role
- Brief JSDoc on key public methods only (avoid internal methods)

The flow builders are well-documented already - focus on @example blocks and any gaps.
  </action>
  <verify>TypeScript compiles: `cd /Users/jtsmith/board_game_service/BoardSmith && pnpm exec tsc --noEmit -p packages/engine`</verify>
  <done>Flow builders have comprehensive JSDoc with examples, FlowEngine has class-level docs</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm exec tsc --noEmit -p packages/engine` passes
- [ ] Action builder has class and method JSDoc
- [ ] Filter helpers have JSDoc with examples
- [ ] Flow builders have JSDoc with @example blocks
- [ ] FlowEngine has class-level JSDoc
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors introduced
- Action and Flow APIs are well-documented for library users
</success_criteria>

<output>
After completion, create `.planning/phases/10-public-api-jsdoc/10-02-SUMMARY.md`
</output>
