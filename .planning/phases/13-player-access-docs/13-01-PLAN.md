---
phase: 13-player-access-docs
plan: 01
type: execute
---

<objective>
Document the new player access pattern (players as GameElements) with comprehensive JSDoc.

Purpose: Help BoardSmith library users understand how to work with players after the Phase 12 changes.
Output: Comprehensive JSDoc documentation on Player class and Game player helpers.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-player-in-tree/12-01-SUMMARY.md
@.planning/phases/12-player-in-tree/12-03-SUMMARY.md

**Prior work:**
- Phase 12 completed: Player now extends GameElement
- All player access via `game.all(Player)`, `game.getPlayer()`, etc.
- PlayerCollection removed entirely

**Files to document:**
- packages/engine/src/player/player.ts - Player class
- packages/engine/src/element/game.ts - Game player helper methods

**Established JSDoc patterns from Phase 10:**
@packages/engine/src/element/game-element.ts (reference for JSDoc style)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add comprehensive JSDoc to Player class</name>
  <files>packages/engine/src/player/player.ts</files>
  <action>
Add comprehensive JSDoc documentation to the Player class:

1. **Class-level documentation** explaining:
   - Players are now GameElements in the tree (searchable via `game.all(Player)`)
   - How to create custom Player subclasses
   - The key properties (position, color, _isCurrent)
   - Migration note from old API

2. **Method/property JSDoc** with examples:
   - `position` - explain 1-indexed nature
   - `color` - player color for UI
   - `isFirstPlayer` - getter explanation
   - `isCurrent()` / `setCurrent()` - turn tracking
   - `allMy()` / `my()` / `hasElement()` - ownership queries with examples

3. **Example section** in class JSDoc showing:
   - How to define a custom Player class
   - How to find players: `game.all(Player)`, `game.getPlayer(1)`
   - How to check ownership: `player.allMy(Card)`

Follow the JSDoc style established in game-element.ts (see Phase 10 work).
  </action>
  <verify>TypeScript compiles, JSDoc appears in IDE hover tooltips</verify>
  <done>Player class has comprehensive JSDoc with examples for all public APIs</done>
</task>

<task type="auto">
  <name>Task 2: Enhance JSDoc on Game player helper methods</name>
  <files>packages/engine/src/element/game.ts</files>
  <action>
Enhance JSDoc on the Player Helpers section (around line 1301):

1. **Add section comment** explaining the player access pattern:
   - Players are direct children of Game in the element tree
   - These helpers provide convenient access patterns
   - Link to Player class for more info

2. **Enhance existing method JSDoc** with examples:
   - `currentPlayer` - example in flow context
   - `firstPlayer` - when to use vs getPlayer(1)
   - `getPlayer(position)` - example with type assertion for custom Player
   - `getPlayerOrThrow(position)` - when to use (actions, flows)
   - `setCurrentPlayer()` - typical usage in turn-based games
   - `nextPlayer()` / `previousPlayer()` - circular behavior with example
   - `nextAfter()` / `previousBefore()` - non-current-player variants
   - `others()` - filtering for target selection
   - `playerChoices()` - already well documented, verify complete

3. **Add "See also" references** connecting:
   - `game.all(Player)` for filtering
   - Player class methods like `allMy()`

4. **Document the static PlayerClass pattern** for custom Player types with a complete example.
  </action>
  <verify>TypeScript compiles, JSDoc appears in IDE hover tooltips</verify>
  <done>All Game player helper methods have enhanced JSDoc with examples</done>
</task>

<task type="auto">
  <name>Task 3: Add anti-pattern warnings in comments</name>
  <files>
packages/engine/src/player/player.ts,
packages/engine/src/element/game.ts
  </files>
  <action>
Add anti-pattern warnings learned from MERC post-mortem:

1. **In Player class JSDoc**, add a warning section:
   - Anti-pattern: Duplicating player data in other elements
   - Anti-pattern: Using fallbacks when player data isn't found
   - Correct approach: Find player via tree search, fail loudly if not found

2. **In Game player helpers**, add notes:
   - Explain that players are in the element tree
   - `game.first(Player, ...)` and `game.all(Player, ...)` work for complex queries
   - Warn against caching player references that might become stale

These warnings help future developers avoid the "player data in two worlds" problem.
  </action>
  <verify>JSDoc renders correctly in IDE</verify>
  <done>Anti-pattern warnings documented to prevent "two worlds" problem</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm build` succeeds in packages/engine
- [ ] Player class JSDoc visible in IDE hover
- [ ] Game player helper JSDoc visible in IDE hover
- [ ] Examples are syntactically correct
- [ ] Anti-pattern warnings included
</verification>

<success_criteria>

- Player class fully documented with examples
- All Game player helper methods documented
- Anti-patterns explicitly warned against
- Phase 13 complete
- Milestone v0.6 complete
</success_criteria>

<output>
After completion, create `.planning/phases/13-player-access-docs/13-01-SUMMARY.md`:

# Phase 13 Plan 01: Player Access Documentation Summary

**[Substantive one-liner]**

## Accomplishments
- [Key outcomes]

## Files Modified
- `packages/engine/src/player/player.ts` - Comprehensive JSDoc
- `packages/engine/src/element/game.ts` - Enhanced player helper JSDoc

## Decisions Made
[Key decisions, or "None"]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Step
Phase 13 complete. Milestone v0.6 complete. Ready for /gsd:complete-milestone.
</output>
