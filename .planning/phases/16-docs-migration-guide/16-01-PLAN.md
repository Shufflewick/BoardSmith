---
phase: 16-docs-migration-guide
plan: 01
type: execute
---

<objective>
Update documentation and create migration guide for the object-based condition API.

Purpose: Document the new condition format and provide a migration guide for MERC team (and future users) to transition from function-based to object-based conditions.
Output: Updated docs/actions-and-flow.md, docs/common-patterns.md, and new docs/condition-migration-guide.md
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summaries (condition refactor context):
@.planning/phases/14-condition-api-refactor/14-01-SUMMARY.md
@.planning/phases/14-condition-api-refactor/14-02-SUMMARY.md
@.planning/phases/15-game-migrations/15-01-SUMMARY.md
@.planning/phases/15-game-migrations/15-02-SUMMARY.md

# Current documentation to update:
@docs/actions-and-flow.md
@docs/common-patterns.md

# New condition API (source of truth for JSDoc):
@packages/engine/src/action/action-builder.ts

**Tech stack available:** None new (documentation only)
**Established patterns:** Object-based conditions with labeled predicates

**Key decisions from Phase 14:**
- Object conditions use Record<string, predicate> - keys are labels, values are predicates
- Function conditions still work but produce no automatic trace
- evaluateCondition helper handles both formats

**From Phase 15:**
- Compound conditions (&&) split into separate labeled predicates
- Labels describe WHY the condition exists, not just what it checks
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update actions-and-flow.md with object-based conditions</name>
  <files>docs/actions-and-flow.md</files>
  <action>
Update the "Conditions" section (around line 370-382) to:
1. Show object-based format as the **preferred** approach with a full example
2. Keep the function format as "legacy" for backward compatibility
3. Explain that object format provides automatic debugging via labeled predicates
4. Add a note about compound conditions being split into separate labeled predicates

Update the "Basic Action Structure" example (line 17) to use object format instead of function format.

Update any other `.condition((ctx) => ...)` examples in the file to use object format where it makes sense (particularly in examples that are teaching the API).

Do NOT update the examples that are showing complete game implementations (like the Go Fish example at line 631) - those should be migrated separately and may already be done.
  </action>
  <verify>grep -n "condition" docs/actions-and-flow.md shows object format in main documentation sections</verify>
  <done>
- Conditions section shows object format as preferred
- Basic Action Structure example uses object format
- Function format documented as legacy/backward-compatible
- Clear explanation of auto-tracing benefit
  </done>
</task>

<task type="auto">
  <name>Task 2: Update common-patterns.md condition examples</name>
  <files>docs/common-patterns.md</files>
  <action>
Find the `.condition((ctx) =>` example around line 479-482 and update it to use object format:

```typescript
.condition({
  'can afford building cost': (ctx) => {
    const player = ctx.player as MyPlayer;
    return player.canAfford({ wood: 5, gold: 2 });
  }
})
```

Search for any other `.condition(` examples in the file and update them to object format.
  </action>
  <verify>grep -n "\.condition" docs/common-patterns.md shows object format usage</verify>
  <done>All condition examples in common-patterns.md use object format</done>
</task>

<task type="auto">
  <name>Task 3: Create condition migration guide</name>
  <files>docs/condition-migration-guide.md</files>
  <action>
Create a focused migration guide with:

1. **Why migrate** - Explain the debugging benefits (automatic tracing, labeled failures)
2. **The change** - Show before/after comparison
3. **Migration patterns**:
   - Simple conditions: `(ctx) => bool` â†’ `{ 'label': (ctx) => bool }`
   - Compound conditions (&&): Split into separate labeled predicates
   - Multiple conditions: Each gets a descriptive label
4. **Examples from real games** - Reference patterns from Phase 15 migrations:
   - Go Fish: player can take action
   - Cribbage: phase checks (discarding, play, scoring)
   - Checkers: multi-jump logic
5. **What labels should say** - Describe WHY, not WHAT
6. **Backward compatibility** - Function format still works, no breaking changes

Keep it concise - this is a practical guide, not comprehensive API docs.
  </action>
  <verify>cat docs/condition-migration-guide.md shows complete migration guide with before/after examples</verify>
  <done>
- Migration guide exists with clear before/after examples
- Explains debugging benefits
- Shows compound condition pattern
- References real game examples
- Notes backward compatibility
  </done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] docs/actions-and-flow.md shows object format as preferred in Conditions section
- [ ] docs/common-patterns.md examples use object format
- [ ] docs/condition-migration-guide.md exists with migration patterns
- [ ] No broken markdown formatting in any modified files
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Object-based conditions documented as the preferred approach
- Migration guide provides actionable guidance for MERC team
- v0.7 milestone complete
</success_criteria>

<output>
After completion, create `.planning/phases/16-docs-migration-guide/16-01-SUMMARY.md`:

# Phase 16 Plan 01: Documentation and Migration Guide Summary

**[Substantive one-liner]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `docs/actions-and-flow.md` - Updated Conditions section, object format as preferred
- `docs/common-patterns.md` - Updated condition examples
- `docs/condition-migration-guide.md` - New migration guide

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 16 complete. v0.7 milestone complete. Ready for next milestone.
</output>
