---
phase: 27-llm-strategy-generation
plan: 01
type: execute
---

<objective>
Create `/generate-ai` Claude Code slash command that guides Claude through generating custom AI evaluation functions for BoardSmith games.

Purpose: Enable Tier 3 AI generation where Claude analyzes game rules interactively and produces tailored evaluation heuristics, complementing the automated Tier 1/2 training.
Output: New slash command installable via `boardsmith claude install`, instructions file, updated CLI.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context
@.planning/phases/26.1-parallel-only-training/26.1-01-SUMMARY.md

# Existing slash command infrastructure
@packages/cli/src/commands/install-claude-command.ts
@packages/cli/src/slash-command/design-game.template.md
@packages/cli/src/slash-command/instructions.md

# AI trainer infrastructure (for reference in instructions)
@packages/ai-trainer/src/code-generator.ts
@packages/ai-trainer/src/introspector.ts
@packages/ai-trainer/src/feature-templates.ts

# CLI
@packages/cli/src/cli.ts

**Tech stack available:**
- Claude Code slash commands via ~/.claude/commands/*.md
- ParallelTrainer for automated training
- generateAICode for output formatting
- introspectGame for game structure analysis
- generateCandidateFeatures for feature discovery

**Established patterns:**
- Slash command template references instructions.md for detailed guidance
- {{BOARDSMITH_ROOT}} placeholder replaced at install time
- install-claude-command.ts handles installation/uninstallation
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create generate-ai slash command template and instructions</name>
  <files>packages/cli/src/slash-command/generate-ai.template.md, packages/cli/src/slash-command/generate-ai-instructions.md</files>
  <action>
Create two files for the /generate-ai slash command:

1. `generate-ai.template.md` - Simple entry point (following design-game.template.md pattern):
   - Reference instructions file at {{BOARDSMITH_ROOT}}
   - Provide BOARDSMITH_ROOT path

2. `generate-ai-instructions.md` - Detailed Claude instructions:

   **Phase 1: Project Validation**
   - Verify user is in a BoardSmith game project (boardsmith.json exists)
   - Check if ai.ts already exists (warn about overwriting)

   **Phase 2: Game Analysis**
   - Run `npx boardsmith analyze --json` to get game structure
   - Read game rules files (elements.ts, game.ts, actions.ts, flow.ts)
   - Understand win conditions, scoring, and key mechanics

   **Phase 3: Strategy Discussion**
   - Ask user about key strategic concepts:
     - "What positions are strong in this game?"
     - "What should the AI prioritize?"
     - "Are there any traps or bad moves to avoid?"
   - Identify game type (connection, capture, racing, collection, territory)

   **Phase 4: Feature Design**
   - Based on game structure and user input, design evaluation features:
     - For connection games: path distance to goal, blocking opponent
     - For capture games: material count, piece safety, threats
     - For racing games: score lead, proximity to target
     - For collection games: set completion progress
   - Each feature needs: id, description, weight, checker function

   **Phase 5: Code Generation**
   - Generate ai.ts following the existing code-generator.ts output format
   - Use proper imports (Game, Objective from @boardsmith/ai)
   - Use game-specific types from ./game.js and ./elements.js
   - Generate checker functions that return boolean
   - Include comments with feature rationale

   **Phase 6: Validation**
   - Write the ai.ts file
   - Run `npx tsc --noEmit` to verify TypeScript compiles
   - Suggest testing with `boardsmith dev --ai 1`

   **Critical Rules:**
   - Read the existing code-generator.ts to understand output format exactly
   - Use introspector output to understand available element types
   - Checker functions must return boolean (true = good for player)
   - Weights: positive = maximize, negative = minimize
   - Always verify TypeScript compiles before declaring done
  </action>
  <verify>
Files exist:
- packages/cli/src/slash-command/generate-ai.template.md
- packages/cli/src/slash-command/generate-ai-instructions.md

generate-ai.template.md contains {{BOARDSMITH_ROOT}} placeholder
generate-ai-instructions.md contains Phase 1-6 sections
  </verify>
  <done>Both slash command files created with complete instructions</done>
</task>

<task type="auto">
  <name>Task 2: Update install-claude-command.ts to install both commands</name>
  <files>packages/cli/src/commands/install-claude-command.ts</files>
  <action>
Modify install-claude-command.ts to install both slash commands:

1. Extract common installation logic into a helper function:
   ```typescript
   async function installCommand(
     commandName: string,
     boardsmithRoot: string,
     targetDir: string,
     force: boolean
   ): Promise<boolean>
   ```

2. Update installClaudeCommand to install both:
   - design-game.md (existing)
   - generate-ai.md (new)

3. Update uninstallClaudeCommand to remove both commands

4. Update success messages to list both installed commands:
   ```
   âœ“ Installed BoardSmith slash commands for Claude Code

     Location: ~/.claude/commands/
     Commands:
       /design-game - Design and generate a new BoardSmith game
       /generate-ai - Generate AI evaluation functions for existing game
   ```

Do NOT use loops or arrays for the two commands - keep it explicit and simple.
  </action>
  <verify>Run `cat packages/cli/src/commands/install-claude-command.ts | grep -E "(design-game|generate-ai)"` shows both commands referenced</verify>
  <done>install-claude-command.ts installs and uninstalls both design-game and generate-ai commands</done>
</task>

<task type="auto">
  <name>Task 3: Update CLI help text and README</name>
  <files>packages/cli/src/cli.ts, packages/ai-trainer/README.md</files>
  <action>
1. Update packages/cli/src/cli.ts:
   - Update claudeCmd.command('install') description to mention both commands
   - Update claudeCmd.command('uninstall') description similarly

2. Update packages/ai-trainer/README.md:
   - Add section about Tier 3 LLM-assisted AI generation
   - Document that /generate-ai slash command is available
   - Explain the tiered system:
     - Tier 1: Zero-config heuristics (automatic)
     - Tier 2: Self-play training (`boardsmith train-ai`)
     - Tier 3: LLM-assisted generation (`/generate-ai` in Claude Code)
  </action>
  <verify>
grep "generate-ai" packages/cli/src/cli.ts
grep -i "tier" packages/ai-trainer/README.md
  </verify>
  <done>CLI help and README document the /generate-ai command and tiered AI system</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npx tsc --noEmit` in packages/cli passes
- [ ] generate-ai.template.md and generate-ai-instructions.md exist
- [ ] install-claude-command.ts references both commands
- [ ] README documents the tiered AI system
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Slash command infrastructure ready for /generate-ai
- Documentation updated to describe Tier 3 AI generation
</success_criteria>

<output>
After completion, create `.planning/phases/27-llm-strategy-generation/27-01-SUMMARY.md`:

# Phase 27 Plan 01: LLM Strategy Generation Summary

**[Substantive one-liner about what shipped]**

## Accomplishments

- Created /generate-ai slash command for Claude Code
- [Other accomplishments]

## Files Created/Modified

- `packages/cli/src/slash-command/generate-ai.template.md` - Slash command entry point
- `packages/cli/src/slash-command/generate-ai-instructions.md` - Detailed AI generation instructions
- `packages/cli/src/commands/install-claude-command.ts` - Updated to install both commands
- `packages/cli/src/cli.ts` - Updated help text
- `packages/ai-trainer/README.md` - Added Tier 3 documentation

## Decisions Made

[Key decisions and rationale]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Phase 27 complete, ready for Phase 28: integration-verification
</output>
