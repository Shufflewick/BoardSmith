---
phase: 47-initial-interview-and-generation
plan: 02
type: execute
wave: 2
depends_on: ["47-01"]
files_modified:
  - src/cli/slash-command/instructions.md
autonomous: true

must_haves:
  truths:
    - "PROJECT.md created with game identity, core mechanics, deferred ideas"
    - "STATE.md created with phase tracking"
    - "Generated code compiles successfully"
    - "Designer prompted to playtest"
  artifacts:
    - path: "src/cli/slash-command/instructions.md"
      provides: "Artifact templates and code generation instructions"
      contains: "PROJECT.md Template"
    - path: "src/cli/slash-command/instructions.md"
      provides: "STATE.md template"
      contains: "STATE.md Template"
  key_links:
    - from: "instructions.md"
      to: "generated code"
      via: "tsc --noEmit verification"
      pattern: "tsc --noEmit"
---

<objective>
Add artifact templates (PROJECT.md, STATE.md) and code generation patterns to instructions.md.

Purpose: Enable Claude to create game state files and generate minimal playable code
Output: Complete instructions.md with templates and generation patterns
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/47-initial-interview-and-generation/47-RESEARCH.md
@.planning/phases/47-initial-interview-and-generation/47-01-SUMMARY.md

# Source files
@src/cli/slash-command/instructions.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add artifact templates to instructions.md</name>
  <files>src/cli/slash-command/instructions.md</files>
  <action>
Add artifact template sections to instructions.md after the Governor Pattern section:

**Phase 3: Create Artifacts**
Requirements covered: ART-01 through ART-03

**PROJECT.md Template** (ART-01):
```markdown
# [Game Name]

## Identity
**Theme:** [One sentence theme/setting from interview]
**Core Loop:** [One sentence description of what players do]
**Win Condition:** [How someone wins]

## Core Mechanics

### Components
- **Cards:** [Description from interview, or "None"]
- **Board:** [Description from interview, or "None"]
- **Dice:** [Description from interview, or "None"]
- **Tokens:** [Description from interview, or "None"]

### Turn Structure
[Sequential/Simultaneous/Phased from interview]

### Round End
[From interview]

### Game End
[From interview]

## Deferred Ideas
Ideas captured during design that we'll implement in later phases:

- [ ] [Captured ideas from governor pattern]
```

**STATE.md Template** (ART-02):
```markdown
# [Game Name] - Design State

## Current Phase
**Phase:** 1 - Initial Generation
**Status:** In Progress

## Progress
- [x] Interview complete
- [x] PROJECT.md created
- [ ] Code generated
- [ ] Code compiles
- [ ] Ready for playtest

## Last Action
Created PROJECT.md and STATE.md from interview

## Next Steps
Generate initial game code
```

**Phase PLAN.md Template** (ART-03) - simplified for design-game:
```markdown
# Phase 1: Initial Generation

## Goal
Create minimal playable game matching interview requirements

## Tasks
1. Generate elements.ts with component types
2. Generate game.ts with setup
3. Generate flow.ts with turn structure
4. Generate actions.ts with placeholder action
5. Generate index.ts with game definition
6. Verify compilation with tsc --noEmit

## Success
- Game compiles
- Can run boardsmith dev
- Basic turn loop works
```

Instruct Claude to:
1. Create PROJECT.md with interview data
2. Create STATE.md with initial status
3. Update STATE.md progress as each step completes
  </action>
  <verify>grep "PROJECT.md Template" src/cli/slash-command/instructions.md shows template section</verify>
  <done>Artifact templates added covering ART-01, ART-02, ART-03</done>
</task>

<task type="auto">
  <name>Task 2: Add code generation patterns to instructions.md</name>
  <files>src/cli/slash-command/instructions.md</files>
  <action>
Add code generation section to instructions.md after artifact templates:

**Phase 4: Generate Initial Code**
Requirements covered: GEN-01 through GEN-04

Instruct Claude to run `boardsmith init <game-name>` first to scaffold the project, then MODIFY the generated files (not create from scratch).

**elements.ts Generation** (GEN-01):
Based on interview component types, modify the template:
- Card games: Import Card, Hand, Deck from engine; create custom Card class with game-specific properties
- Board games: Import Piece, Grid, GridCell from engine; create Cell class with row/col, Board class
- Mixed: Combine as needed

Include code examples from RESEARCH.md (Go Fish pattern for cards, Hex pattern for boards).

**game.ts Generation** (GEN-02):
- Import elements from ./elements.js
- Create game class with placeholder setup
- Register elements
- Create basic game structure (deck/board)
- Implement stub isFinished() returning false
- Implement stub getWinners() returning []
- Register placeholder action
- Set flow

**flow.ts Generation** (GEN-03):
Map interview turn structure to flow primitives:
- Sequential: loop > eachPlayer > actionStep
- Simultaneous: loop > parallel > actionStep (rare)
- Phased: loop > sequence of actionSteps

Include the simple turn loop example from RESEARCH.md.

**actions.ts Generation** (GEN-04):
Create ONE placeholder action that:
- Has a simple prompt ("Take your turn")
- Logs a message when executed
- Returns success

This is intentionally minimal - real actions come in later phases.

**index.ts**: Standard game definition export.

**CRITICAL**: Generate minimal code that compiles and runs. Do NOT try to implement complete game logic. The goal is a playtest loop, not a finished game.
  </action>
  <verify>grep "elements.ts Generation" src/cli/slash-command/instructions.md shows generation section</verify>
  <done>Code generation patterns added covering GEN-01 through GEN-04</done>
</task>

<task type="auto">
  <name>Task 3: Add verification and playtest prompt</name>
  <files>src/cli/slash-command/instructions.md</files>
  <action>
Add final sections to instructions.md:

**Phase 5: Verify Compilation** (GEN-05):
```bash
npx tsc --noEmit
```

If errors:
1. Read the error message carefully
2. Fix the issue
3. Run tsc again
4. Repeat until clean

Update STATE.md progress checkboxes as each step completes.

**Phase 6: Playtest Prompt**
After successful compilation, display:

```markdown
## Ready to Playtest!

Your game compiles and runs. Here's how to test it:

1. Run `boardsmith dev` to start the development server
2. Open the URL shown in your browser
3. Play a few turns with the placeholder action
4. Notice what feels missing or broken

When ready to add more, run `/design-game` again. I'll ask:
- What worked well?
- What felt missing?
- Which deferred idea should we add first?

**Your Deferred Ideas:**
[List from PROJECT.md]
```

Update STATE.md:
- Status: Complete
- All progress checkboxes checked
- Next Steps: "Playtest, then run /design-game to continue"
  </action>
  <verify>grep "Ready to Playtest" src/cli/slash-command/instructions.md shows playtest prompt</verify>
  <done>Verification and playtest sections added, covering GEN-05</done>
</task>

</tasks>

<verification>
- [ ] PROJECT.md template in instructions.md with Deferred Ideas section
- [ ] STATE.md template in instructions.md with progress tracking
- [ ] Phase PLAN.md template in instructions.md
- [ ] Code generation patterns for elements, game, flow, actions, index
- [ ] tsc --noEmit verification step
- [ ] Playtest prompt with deferred ideas reminder
</verification>

<success_criteria>
Instructions contain complete artifact templates and code generation patterns for Phase 1 workflow
</success_criteria>

<output>
After completion, create `.planning/phases/47-initial-interview-and-generation/47-02-SUMMARY.md`
</output>
