---
phase: 68-game-updates
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - /Users/jtsmith/BoardSmithGames/hex/src/rules/game.ts
  - /Users/jtsmith/BoardSmithGames/hex/src/rules/elements.ts
  - /Users/jtsmith/BoardSmithGames/hex/src/ui/App.vue
  - /Users/jtsmith/BoardSmithGames/hex/src/ui/components/HexBoard.vue
  - /Users/jtsmith/BoardSmithGames/checkers/src/rules/game.ts
  - /Users/jtsmith/BoardSmithGames/checkers/src/rules/elements.ts
  - /Users/jtsmith/BoardSmithGames/checkers/src/ui/components/CheckersBoard.vue
  - /Users/jtsmith/BoardSmithGames/checkers/boardsmith.json
autonomous: true

must_haves:
  truths:
    - "Hex game stones render in correct player colors without fallback chains"
    - "Hex player instructions show correct colors from player.color property"
    - "Checkers game pieces render in red/dark gray colors from player.color"
    - "No DEFAULT_PLAYER_COLORS imports exist in any Hex or Checkers files"
    - "No deprecated color constants exist in any Hex or Checkers files"
  artifacts:
    - path: "/Users/jtsmith/BoardSmithGames/hex/src/rules/game.ts"
      provides: "HexGame without manual color assignment"
      not_contains: "DEFAULT_PLAYER_COLORS"
    - path: "/Users/jtsmith/BoardSmithGames/hex/src/rules/elements.ts"
      provides: "HexPlayer using inherited player.color"
      not_contains: "DEFAULT_PLAYER_COLORS"
    - path: "/Users/jtsmith/BoardSmithGames/hex/src/ui/App.vue"
      provides: "App.vue using player.color directly"
      not_contains: "DEFAULT_PLAYER_COLORS"
    - path: "/Users/jtsmith/BoardSmithGames/hex/src/ui/components/HexBoard.vue"
      provides: "HexBoard using player.color directly"
      not_contains: "DEFAULT_PLAYER_COLORS"
    - path: "/Users/jtsmith/BoardSmithGames/checkers/src/rules/game.ts"
      provides: "CheckersGame without manual color assignment"
      not_contains: "CHECKERS_DEFAULT_COLORS"
    - path: "/Users/jtsmith/BoardSmithGames/checkers/src/rules/elements.ts"
      provides: "CheckersPlayer without shadowing color property"
      not_contains: "color: string = "
    - path: "/Users/jtsmith/BoardSmithGames/checkers/src/ui/components/CheckersBoard.vue"
      provides: "CheckersBoard using player.color directly"
      not_contains: "DEFAULT_CHECKERS_COLORS"
    - path: "/Users/jtsmith/BoardSmithGames/checkers/boardsmith.json"
      provides: "Checkers config with custom red/dark palette"
      contains: "colors"
  key_links:
    - from: "hex/src/ui/components/HexBoard.vue"
      to: "players prop"
      via: "direct player.color access"
      pattern: "props\\.players\\[.*\\]\\.color"
    - from: "checkers/src/ui/components/CheckersBoard.vue"
      to: "players prop"
      via: "direct player.color access"
      pattern: "players\\[.*\\]\\.color"
---

<objective>
Migrate Hex and Checkers games to use the engine-managed player.color API, removing all deprecated DEFAULT_PLAYER_COLORS imports and fallback patterns.

Purpose: Complete v2.5 Player Colors Refactor by migrating all games to the new API. This eliminates fragmented color handling, reduces code complexity, and ensures consistent behavior across all games.

Output: Both games using player.color directly with no fallback chains or manual color assignment.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/68-game-updates/68-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Hex game to player.color API</name>
  <files>/Users/jtsmith/BoardSmithGames/hex/src/rules/game.ts, /Users/jtsmith/BoardSmithGames/hex/src/rules/elements.ts, /Users/jtsmith/BoardSmithGames/hex/src/ui/App.vue, /Users/jtsmith/BoardSmithGames/hex/src/ui/components/HexBoard.vue</files>
  <action>
Remove deprecated color handling from all Hex game files:

1. **hex/src/rules/game.ts**:
   - Remove `import { DEFAULT_PLAYER_COLORS } from 'boardsmith/session';` (line 2)
   - Remove the entire `PlayerConfig` interface (lines 10-15) - not needed, engine handles colors
   - Remove `playerConfigs?: PlayerConfig[]` from `HexOptions` interface (line 24)
   - Remove `this.applyPlayerColors(options.playerConfigs);` call in constructor (line 57)
   - Remove the entire `applyPlayerColors()` method (lines 91-103)

2. **hex/src/rules/elements.ts**:
   - Remove `import { DEFAULT_PLAYER_COLORS } from 'boardsmith/session';` (line 2)
   - Simplify `HexPlayer.getColorHex()` method (lines 198-201):
     - Change from fallback chain to direct return: `return this.color;`
     - The engine guarantees player.color is always set

3. **hex/src/ui/App.vue**:
   - Remove `DEFAULT_PLAYER_COLORS` from the import on line 2
   - Simplify `getPlayerColorHex()` function (lines 7-11):
     - Change to: `function getPlayerColorHex(player: any): string { return player?.color ?? '#888888'; }`
     - The fallback '#888888' is only for null safety, not for missing colors

4. **hex/src/ui/components/HexBoard.vue**:
   - Remove `DEFAULT_PLAYER_COLORS` from the import on line 11
   - Simplify `getPlayerColors` computed (lines 140-150):
     - Change to: `const getPlayerColors = computed(() => props.players.map(p => p.color));`
     - Remove all fallback logic - player.color is guaranteed
   - Simplify `myColor` computed (line 153):
     - Change to: `const myColor = computed(() => props.players[props.playerSeat - 1]?.color ?? '#888888');`
   - Simplify `opponentColor` computed (lines 154-157):
     - Change to: `const opponentColor = computed(() => props.players[props.playerSeat === 1 ? 1 : 0]?.color ?? '#888888');`

Why no fallbacks to DEFAULT_PLAYER_COLORS: The engine now guarantees player.color is always a valid hex string. Fallbacks mask bugs rather than providing safety.
  </action>
  <verify>
1. Run `grep -r "DEFAULT_PLAYER_COLORS" /Users/jtsmith/BoardSmithGames/hex/src/` - should return no matches
2. Run `grep -r "applyPlayerColors" /Users/jtsmith/BoardSmithGames/hex/src/` - should return no matches
3. Run `cd /Users/jtsmith/BoardSmithGames/hex && npm run typecheck` - should pass with no errors
4. Run `cd /Users/jtsmith/BoardSmithGames/hex && npm run build` - should complete successfully
  </verify>
  <done>Hex game uses player.color directly with no deprecated imports or fallback chains</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Checkers game to player.color API</name>
  <files>/Users/jtsmith/BoardSmithGames/checkers/src/rules/game.ts, /Users/jtsmith/BoardSmithGames/checkers/src/rules/elements.ts, /Users/jtsmith/BoardSmithGames/checkers/src/ui/components/CheckersBoard.vue, /Users/jtsmith/BoardSmithGames/checkers/boardsmith.json</files>
  <action>
Remove deprecated color handling from all Checkers game files and configure custom palette:

1. **checkers/boardsmith.json**:
   - Add colors array to preserve checkers theme: `"colors": ["#e74c3c", "#2c3e50"]`
   - Add after "categories" line: red (#e74c3c) for Player 1, dark gray (#2c3e50) for Player 2
   - This uses the new system correctly - engine assigns these colors to players

2. **checkers/src/rules/game.ts**:
   - Remove `import { DEFAULT_PLAYER_COLORS } from 'boardsmith/session';` (line 2)
   - Remove `const CHECKERS_DEFAULT_COLORS = ['#e74c3c', '#2c3e50'] as const;` (line 8)
   - Remove the entire `PlayerConfig` interface (lines 13-18)
   - Remove `playerConfigs?: PlayerConfig[]` from `CheckersOptions` interface (line 26)
   - Remove `this.applyPlayerColors(options.playerConfigs);` call in constructor (line 62)
   - Remove the entire `applyPlayerColors()` method (lines 92-105)
   - The game announcement messages on lines 85-86 can stay - they use `player.color` which is now auto-set

3. **checkers/src/rules/elements.ts**:
   - Remove the `color: string = '#e74c3c';` property from `CheckersPlayer` class (line 123)
   - This was shadowing the inherited `player.color` property from the Player base class
   - The base Player class already has the color property, engine sets it from game config

4. **checkers/src/ui/components/CheckersBoard.vue**:
   - Remove `const DEFAULT_CHECKERS_COLORS = ['#e74c3c', '#2c3e50'] as const;` (line 481)
   - Simplify `getPlayerColor()` function (lines 485-493):
     - Change to: `function getPlayerColor(playerSeat: number): string { return props.players[playerSeat - 1]?.color ?? '#888888'; }`
     - Remove all fallback logic to DEFAULT_CHECKERS_COLORS

Why add colors to boardsmith.json: Checkers has a traditional red/black (dark) theme. By adding the colors to the game config, the engine assigns these specific colors instead of the default palette, preserving the game's visual identity while using the new system correctly.
  </action>
  <verify>
1. Run `grep -r "DEFAULT_PLAYER_COLORS\|DEFAULT_CHECKERS_COLORS\|CHECKERS_DEFAULT_COLORS" /Users/jtsmith/BoardSmithGames/checkers/src/` - should return no matches
2. Run `grep -r "applyPlayerColors" /Users/jtsmith/BoardSmithGames/checkers/src/` - should return no matches
3. Run `grep "colors" /Users/jtsmith/BoardSmithGames/checkers/boardsmith.json` - should show colors array
4. Run `cd /Users/jtsmith/BoardSmithGames/checkers && npm run typecheck` - should pass with no errors
5. Run `cd /Users/jtsmith/BoardSmithGames/checkers && npm run build` - should complete successfully
  </verify>
  <done>Checkers game uses player.color directly with custom palette in config</done>
</task>

<task type="auto">
  <name>Task 3: Verify both games work correctly</name>
  <files></files>
  <action>
Run integration verification to ensure both games work with the new color API:

1. **Hex game verification**:
   - Start Hex dev server: `cd /Users/jtsmith/BoardSmithGames/hex && npm run dev`
   - In browser, verify:
     - Player colors show correctly in game instructions (red/blue for default)
     - Stones render with correct player colors
     - Color gradients in SVG work correctly
   - Stop the dev server

2. **Checkers game verification**:
   - Start Checkers dev server: `cd /Users/jtsmith/BoardSmithGames/checkers && npm run dev`
   - In browser, verify:
     - Player pieces render with red (#e74c3c) and dark gray (#2c3e50) colors
     - Game announcement messages show colors correctly
     - Flying piece animations use correct colors
   - Stop the dev server

3. **Final grep verification**:
   - Confirm no deprecated patterns remain in either game
   - Verify no compile errors in either game

Note: Both games should use the engine-assigned player.color property with zero fallback chains.
  </action>
  <verify>
1. Both games compile without errors
2. Both games render player colors correctly in browser
3. No deprecated color imports or constants remain in codebase
  </verify>
  <done>Both Hex and Checkers games work correctly with new player.color API</done>
</task>

</tasks>

<verification>
1. No DEFAULT_PLAYER_COLORS imports in Hex or Checkers: `grep -r "DEFAULT_PLAYER_COLORS" /Users/jtsmith/BoardSmithGames/{hex,checkers}/src/`
2. No custom color constants in games: `grep -r "CHECKERS_DEFAULT_COLORS\|DEFAULT_CHECKERS_COLORS" /Users/jtsmith/BoardSmithGames/checkers/src/`
3. No applyPlayerColors methods: `grep -r "applyPlayerColors" /Users/jtsmith/BoardSmithGames/{hex,checkers}/src/`
4. Both games typecheck: `cd /Users/jtsmith/BoardSmithGames/hex && npm run typecheck && cd ../checkers && npm run typecheck`
5. Both games build: `cd /Users/jtsmith/BoardSmithGames/hex && npm run build && cd ../checkers && npm run build`
</verification>

<success_criteria>
- GAME-01: Hex game uses player.color for all player-specific styling (stones, instructions, gradients)
- GAME-02: Checkers game uses player.color for piece rendering with custom red/dark palette
- GAME-03: N/A - MERC game does not exist in codebase
- GAME-04: N/A - No other games need migration (Cribbage, Go Fish, Polyhedral Potions don't use player colors)
- No deprecated imports or fallback chains remain in migrated games
- Both games compile and render correctly
</success_criteria>

<output>
After completion, create `.planning/phases/68-game-updates/68-01-SUMMARY.md`
</output>
