---
phase: 85-theatre-erasure
plan: 03
type: execute
wave: 2
depends_on: ["85-01"]
files_modified:
  - src/client/game-connection.ts
  - src/client/types.ts
  - src/client/vue.ts
  - src/ui/components/GameShell.vue
  - src/ui/composables/useCurrentView.ts
  - src/ui/composables/useCurrentView.test.ts
  - src/ui/index.ts
autonomous: true

must_haves:
  truths:
    - "GameConnection.acknowledgeAnimations() method no longer exists"
    - "useGame() no longer returns acknowledgeAnimations"
    - "useCurrentView composable and CURRENT_VIEW_KEY are deleted"
    - "GameShell no longer provides CURRENT_VIEW_KEY or computes currentGameView"
    - "GameShell passes no-op for acknowledge callback to createAnimationEvents (Phase 89 removes entirely)"
    - "Client types no longer reference currentView or acknowledgeAnimations"
  artifacts:
    - path: "src/client/game-connection.ts"
      provides: "GameConnection without acknowledgeAnimations method"
    - path: "src/client/types.ts"
      provides: "PlayerGameState without currentView, no acknowledgeAnimations message type"
    - path: "src/client/vue.ts"
      provides: "useGame without acknowledgeAnimations in return"
    - path: "src/ui/components/GameShell.vue"
      provides: "GameShell without theatre wiring, no-op acknowledge"
    - path: "src/ui/composables/useCurrentView.ts"
      provides: "DELETED"
    - path: "src/ui/composables/useCurrentView.test.ts"
      provides: "DELETED"
    - path: "src/ui/index.ts"
      provides: "Exports without useCurrentView or CURRENT_VIEW_KEY"
  key_links:
    - from: "src/ui/components/GameShell.vue"
      to: "createAnimationEvents"
      via: "acknowledge callback is no-op () => {}"
      pattern: "acknowledge.*=>|acknowledge.*noop"
    - from: "src/ui/index.ts"
      to: "useCurrentView"
      via: "export removed"
      pattern: "no useCurrentView"
---

<objective>
Remove all theatre acknowledgment code from the client SDK and UI layer. The client no longer sends acknowledgeAnimations messages, useGame no longer provides the acknowledge function, GameShell stops providing CURRENT_VIEW_KEY and the currentGameView computed, and the useCurrentView composable is deleted entirely (dead code once theatre is gone).

Purpose: The client and UI layers were the other end of the acknowledge protocol -- they received theatre state, computed currentView, and sent acknowledge messages. With the engine (Plan 01) and session/server (Plan 02) stripped, these references are dead code. This plan runs in parallel with Plan 02 since both depend only on Plan 01.

Output: Client and UI compile cleanly. useCurrentView deleted. GameShell simplified. All non-theatre tests pass.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/85-theatre-erasure/85-RESEARCH.md

@src/client/game-connection.ts
@src/client/types.ts
@src/client/vue.ts
@src/ui/components/GameShell.vue
@src/ui/composables/useCurrentView.ts
@src/ui/composables/useAnimationEvents.ts
@src/ui/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Strip client SDK of acknowledge protocol</name>
  <files>
    src/client/game-connection.ts
    src/client/types.ts
    src/client/vue.ts
  </files>
  <action>
    **`src/client/game-connection.ts`:**
    Remove the `acknowledgeAnimations()` method entirely (search for `acknowledgeAnimations` -- it sends a WebSocket message with type 'acknowledgeAnimations' and upToId). Delete the entire method.

    **`src/client/types.ts`:**
    1. Remove `currentView` field from `PlayerGameState` interface (search `currentView` -- optional field with comment about truth during animation). This mirrors the session types change.
    2. Remove `acknowledgeAnimations` from the outgoing WebSocket message union type (search `acknowledgeAnimations` -- a member with type 'acknowledgeAnimations' and `upToId` field). Remove the entire union member.

    **`src/client/vue.ts`:**
    1. Remove `acknowledgeAnimations` from the interface/type declaration near the top (search for `acknowledgeAnimations` in the type definition)
    2. Remove the `acknowledgeAnimations` function implementation (search for the function that calls `connection.acknowledgeAnimations`)
    3. Remove `acknowledgeAnimations` from the return object of `useGame()` (search for it in the return statement)
  </action>
  <verify>
    - `grep -r "acknowledgeAnimations" src/client/` returns zero results
    - `grep "currentView" src/client/types.ts` returns zero results
    - Run `npx tsc --noEmit 2>&1 | grep "src/client/"` -- expect zero client errors
  </verify>
  <done>
    Client SDK has zero references to acknowledgeAnimations or currentView. GameConnection no longer sends acknowledge messages. useGame no longer provides acknowledge function.
  </done>
</task>

<task type="auto">
  <name>Task 2: Clean GameShell, delete useCurrentView, update UI exports</name>
  <files>
    src/ui/components/GameShell.vue
    src/ui/composables/useCurrentView.ts
    src/ui/composables/useCurrentView.test.ts
    src/ui/index.ts
  </files>
  <action>
    **`src/ui/components/GameShell.vue`:**
    1. Remove `acknowledgeAnimations` from the `useGame()` destructure (search for `acknowledgeAnimations` in the destructuring assignment)
    2. Where `createAnimationEvents` is called with an `acknowledge` callback referencing `acknowledgeAnimations`, replace with a no-op: `acknowledge: () => {}`. Do NOT remove the acknowledge parameter entirely -- Phase 89 (CLI-10) handles that cleanup of the createAnimationEvents composable itself.
    3. Remove the `CURRENT_VIEW_KEY` import (search for `CURRENT_VIEW_KEY` in imports)
    4. Remove the `currentGameView` computed property (search for `currentGameView` -- it is a computed that returns either the theatre state or game view)
    5. Remove the `provide(CURRENT_VIEW_KEY, ...)` call (search for `provide.*CURRENT_VIEW_KEY`)

    **Delete entirely:**
    - `src/ui/composables/useCurrentView.ts` -- dead code, the composable provides/injects CURRENT_VIEW_KEY which no longer exists
    - `src/ui/composables/useCurrentView.test.ts` -- tests for deleted composable

    **`src/ui/index.ts`:**
    Remove the export line for `useCurrentView` and `CURRENT_VIEW_KEY` (search for `useCurrentView` or `CURRENT_VIEW_KEY` in the exports). This is the end of the export chain for these deleted items.
  </action>
  <verify>
    - `grep -r "CURRENT_VIEW_KEY\|useCurrentView\|currentGameView" src/ui/` returns zero results
    - `grep "acknowledgeAnimations" src/ui/components/GameShell.vue` returns zero results
    - `ls src/ui/composables/useCurrentView.ts src/ui/composables/useCurrentView.test.ts 2>&1` shows both files missing
    - Run `npx tsc --noEmit 2>&1 | grep "src/ui/"` -- expect zero UI errors
    - Run `npx vitest run src/ui/ 2>&1 | tail -10` -- all remaining UI tests pass
  </verify>
  <done>
    GameShell cleaned of theatre wiring (no acknowledgeAnimations destructure, no CURRENT_VIEW_KEY provide, no currentGameView computed). useCurrentView composable and tests deleted. UI exports cleaned. createAnimationEvents receives no-op acknowledge callback.
  </done>
</task>

</tasks>

<verification>
- `grep -r "theatre\|Theatre\|acknowledgeAnimations\|currentView\|CURRENT_VIEW_KEY\|useCurrentView" src/client/ src/ui/` returns zero results
- `npx tsc --noEmit 2>&1 | grep -E "src/(client|ui)/"` returns zero errors
- `npx vitest run src/ui/ 2>&1` -- all remaining UI tests pass
- GameShell.vue still works with createAnimationEvents (acknowledge is no-op)
</verification>

<success_criteria>
1. acknowledgeAnimations removed from GameConnection, useGame, and GameShell
2. currentView removed from client PlayerGameState type
3. useCurrentView composable and CURRENT_VIEW_KEY deleted
4. GameShell no longer provides currentGameView
5. Client and UI compile cleanly
6. All remaining UI tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/85-theatre-erasure/85-03-SUMMARY.md`
</output>
